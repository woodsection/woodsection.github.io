<!DOCTYPE html><html lang="ko" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Istio의 Security" /><meta name="author" content="woodsection" /><meta property="og:locale" content="ko" /><meta name="description" content="보안(Security)" /><meta property="og:description" content="보안(Security)" /><link rel="canonical" href="https://woodsection.github.io/posts/istio-security/" /><meta property="og:url" content="https://woodsection.github.io/posts/istio-security/" /><meta property="og:site_name" content="나무계단 블로그" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-25T23:05:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Istio의 Security" /><meta name="twitter:site" content="@not" /><meta name="twitter:creator" content="@woodsection" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"woodsection"},"dateModified":"2022-07-25T23:08:27+09:00","datePublished":"2022-07-25T23:05:00+09:00","description":"보안(Security)","headline":"Istio의 Security","mainEntityOfPage":{"@type":"WebPage","@id":"https://woodsection.github.io/posts/istio-security/"},"url":"https://woodsection.github.io/posts/istio-security/"}</script><title>Istio의 Security | 나무계단 블로그</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="나무계단 블로그"><meta name="application-name" content="나무계단 블로그"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">나무계단 블로그</a></div><div class="site-subtitle font-italic">배운것을 기록합니다</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/woodsection" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/not" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['woodsection+blog','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Istio의 Security</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Istio의 Security</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1658757900" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 25, 2022 </em> </span> <span> Updated <em class="" data-ts="1658758107" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 25, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> woodsection </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="617 words"> <em>3 min</em> read</span></div></div></div><div class="post-content"><h1 id="보안security">보안(Security)</h1><p><img data-src="/assets/img/posts/2022/07/25/istio-security/Untitled.png" alt="Untitled" data-proofer-ignore></p><p><strong>istio를 사용했을 때의 보안적인 특징</strong></p><ul><li>애플리케이션과 인프라 코드의 수정없이 기본적으로 보안이 적용됨<li>기존 보안 시스템과 통합하여 보안 적용<li>신뢰할 수 없는 네트워크에도 보안을 적용할 수 있음</ul><h1 id="아키텍쳐">아키텍쳐</h1><ul><li>CA(Certificate Authority) key와 인증 관리<li>설정 API 서버에서 프록시로 정책을 전달함<ul><li>authentication policies(<strong><a href="https://istio.io/latest/docs/concepts/security/#authentication-policies">authentication policies</a>)</strong><li>authorization policies(<strong><a href="https://istio.io/latest/docs/concepts/security/#authorization-policies">authorization policies</a>)</strong><li>secure naming information(<strong><a href="https://istio.io/latest/docs/concepts/security/#secure-naming">secure naming information</a>)</strong></ul><li>사이드카와 perimeter 프록시는 <a href="https://www.google.com/search?q=Policy+Enforcement+Points&amp;oq=Policy+Enforcement+Points&amp;aqs=chrome..69i57.2104j0j7&amp;sourceid=chrome&amp;ie=UTF-8">PEPs</a>에 따라 클라이언트와 서버간에 안전한 커뮤니케이션<li>Envoy proxy 확장세트는 원격측정과 감시를 관리함</ul><p><img data-src="/assets/img/posts/2022/07/25/istio-security/Untitled1.png" alt="Untitled" data-proofer-ignore></p><ul><li>control plane에서 API서버와 PEPs에 따른 data plane을 관리<li>PEPs는 Envoy를 통해 구현됨</ul><h1 id="istio-identity">Istio identity</h1><p>워크로드간 통신을 위해서는 각자가 신용할 수 있는지 확인하기 위해 서로의 credential을 교환해야함</p><p><strong>클라이언트</strong></p><p>서버의 ID가 <em>**</em><a href="https://istio.io/latest/docs/concepts/security/#secure-naming">secure naming</a>을 통해 워크로드에 인증되어있는지 확인함</p><p><strong>서버</strong></p><p>서버에서는 클라이언트가 특정 정보에 액세스할 수 있는지에 대해 authorization policies를 통해 확인함</p><p>누가 언제 액세스했는지, 워크로드를 사용한 것에 대한 비용 부과, 비용을 지불하지 못한 클라이언트의 거부 등을 수행함</p><p>istio identity는 첫번째로 <code class="language-plaintext highlighter-rouge">service identity</code> 를 request origin의 identity를 결정함</p><p>매우 유연하고 세분화된 service identities를 개인, 그룹 유저에게 제공해줌</p><p>istio는 <code class="language-plaintext highlighter-rouge">service identity</code> 가 없는 플랫폼에선 여러 다른 인스턴스를 통해 identity를 결정하는데, 그 목록은 다음과 같음</p><ul><li>K8s → kubernetes service account<li>GCE → GCP service account<li>On-promises(non-k8s) → user account, custom service account, service name, istio service account, or GCP service account</ul><h1 id="identity-and-certificate-management">Identity and certificate management</h1><p>(신원, 인증관리)</p><p>모든 워크로드에서 X.509 certificate를 사용</p><p><img data-src="/assets/img/posts/2022/07/25/istio-security/Untitled2.png" alt="Untitled" data-proofer-ignore></p><ol><li><code class="language-plaintext highlighter-rouge">istiod</code> 에서 CSR을 받는 gRPC 서비스를 제공<li>[istio-agent → istiod] private key, CSR 전송<li>[istiod] istio의 Certificate Authority를 통해 인증서 발급<li>워크로드가 시작되면 Envoy는 SDS API를 통해 <code class="language-plaintext highlighter-rouge">istio-agent</code>에 인증서와 키를 요청함<li><code class="language-plaintext highlighter-rouge">istio-agent</code>는 <code class="language-plaintext highlighter-rouge">istiod</code> 로부터 받은 인증서와 키를 SDS api를 통해 envoy로 전송<li><code class="language-plaintext highlighter-rouge">istio-agent</code> 에서 워크로드 인증서의 만료여부를 모니터링함<li>위의 과정들이 반복되며 인증서와 키가 순환됨</ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/infra/'>Infra</a>, <a href='/categories/istio/'>Istio</a>, <a href='/categories/security/'>Security</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/servicemesh/" class="post-tag no-text-decoration" >ServiceMesh</a> <a href="/tags/istio/" class="post-tag no-text-decoration" >Istio</a> <a href="/tags/kubernetes/" class="post-tag no-text-decoration" >Kubernetes</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Istio%EC%9D%98+Security+-+%EB%82%98%EB%AC%B4%EA%B3%84%EB%8B%A8+%EB%B8%94%EB%A1%9C%EA%B7%B8&url=https%3A%2F%2Fwoodsection.github.io%2Fposts%2Fistio-security%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Istio%EC%9D%98+Security+-+%EB%82%98%EB%AC%B4%EA%B3%84%EB%8B%A8+%EB%B8%94%EB%A1%9C%EA%B7%B8&u=https%3A%2F%2Fwoodsection.github.io%2Fposts%2Fistio-security%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fwoodsection.github.io%2Fposts%2Fistio-security%2F&text=Istio%EC%9D%98+Security+-+%EB%82%98%EB%AC%B4%EA%B3%84%EB%8B%A8+%EB%B8%94%EB%A1%9C%EA%B7%B8" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/curl/">curl 커맨드의 --user 옵션</a><li><a href="/posts/maven/">Maven이란 ?</a><li><a href="/posts/istio-security/">Istio의 Security</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/istio/">Istio</a> <a class="post-tag" href="/tags/kubernetes/">Kubernetes</a> <a class="post-tag" href="/tags/servicemesh/">ServiceMesh</a> <a class="post-tag" href="/tags/command/">Command</a> <a class="post-tag" href="/tags/linux/">Linux</a></div></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/istio-security-authentication/"><div class="card-body"> <em class="small" data-ts="1658842320" data-df="ll" > Jul 26, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Istio 에서의 authentication</h3><div class="text-muted small"><p> Authentication (인증) 기본 컨셉 Istio에서는 두 가지 authentication(인증) 방식을 제공합니다. Peer authenticaion 클라이언트의 연결을 확인하기 위해 서비스간 인증에 사용되는 인증방식입니다. Istio에서는 서비스 코드의 변경없이 활성화가능한 상호간 TLS를 제...</p></div></div></a></div><div class="card"> <a href="/posts/maven-local/"><div class="card-body"> <em class="small" data-ts="1663488960" data-df="ll" > Sep 18, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Maven Local</h3><div class="text-muted small"><p> 개요 spring 으로 만들어진 레거시 프로젝트를 살펴보다가, 패키지를 가져올때 maven repo가 아닌 로컬에서 빌드해둔 jar 파일을 import 해오는 구문을 발견했습니다. 살펴보던 프로젝트는 msa에서 하나의 서비스 부분이였는데, 구글 protobuf로 만들어둔 dto 클래스 모음 프로젝트를 로컬에 jar로 빌드하고 해당 jar을 각 ...</p></div></div></a></div><div class="card"> <a href="/posts/curl/"><div class="card-body"> <em class="small" data-ts="1663485360" data-df="ll" > Sep 18, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>curl 커맨드의 --user 옵션</h3><div class="text-muted small"><p> Curl 커맨드 curl 명령어는 다음과 같이 사용되며 기본적으로 REST 서비스로 api 요청 테스트등을 위해 사용됩니다. 1 curl [options] &amp;lt;url&amp;gt; –user 옵션 api test를 위해서 curl 명령어 README를 작성하다가 찾게된 내용중에 생소한 --user 옵션이 있어 해당내용에 대해 간단히 기록하려고합니...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/maven/" class="btn btn-outline-primary" prompt="Older"><p>Maven이란 ?</p></a> <a href="/posts/istio-security-authentication/" class="btn btn-outline-primary" prompt="Newer"><p>Istio 에서의 authentication</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://www.rocketpunch.com/@wdsection">woodsection</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/istio/">Istio</a> <a class="post-tag" href="/tags/kubernetes/">Kubernetes</a> <a class="post-tag" href="/tags/servicemesh/">ServiceMesh</a> <a class="post-tag" href="/tags/command/">Command</a> <a class="post-tag" href="/tags/linux/">Linux</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/unregister.js"></script>
